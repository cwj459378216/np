<div>
    <ul class="flex space-x-2 rtl:space-x-reverse">
        <li>
            <a href="javascript:;" class="text-primary hover:underline">{{ 'navigation.collector' | translate }}</a>
        </li>
        <li class="before:mr-2 before:content-['/'] rtl:before:ml-2">
            <span>{{ 'navigation.collector' | translate }}</span>
        </li>
    </ul>
    <div class="pt-5">

        <div class="mb-5">
            <div class="mt-3 flex flex-wrap">
                <a href="javascript:;"
                    class="-mb-[1px] block rounded p-3.5 py-2 !outline-none transition duration-300 hover:bg-primary hover:text-white ltr:mr-2 rtl:ml-2"
                    [ngClass]="{ 'bg-primary text-white': tab2.toLowerCase() == 'home' }" (click)="tab2 = 'home'">
                    {{ 'Collector Analyzer' | translate }}
                </a>

                <a href="javascript:;"
                    class="-mb-[1px] block rounded p-3.5 py-2 !outline-none transition duration-300 hover:bg-primary hover:text-white ltr:mr-2 rtl:ml-2"
                    [ngClass]="{ 'bg-primary text-white': tab2.toLowerCase() == 'profile' }" (click)="setTab('profile')">
                    {{ 'Storage Strategy' | translate }}
                </a>

                <!-- <a href="javascript:;"
                    class="-mb-[1px] block rounded p-3.5 py-2 !outline-none transition duration-300 hover:bg-primary hover:text-white ltr:mr-2 rtl:ml-2"
                    [ngClass]="{ 'bg-primary text-white': tab2.toLowerCase() == 'contact' }" (click)="tab2 = 'contact'">
                    {{ 'Decode' | translate }}
                </a> -->

            </div>
            <div class="flex-1 pt-5 text-sm">
                <div *ngIf="tab2.toLowerCase() === 'home'">
                    <div>
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <h2 class="text-xl"></h2>
                            <div class="flex w-full flex-col gap-4 sm:w-auto sm:flex-row sm:items-center sm:gap-3">
                                <div class="flex gap-3">
                                    <div>
                                        <button type="button" class="btn btn-primary" (click)="editUser()">
                                            <icon-plus class="ltr:mr-2 rtl:ml-2" />

                                            {{ 'general.add' | translate }}
                                        </button>
                                    </div>
                                    <div>
                                        <button type="button" class="btn btn-outline-primary p-2"
                                            [ngClass]="{ 'bg-primary text-white': displayType === 'list' }"
                                            (click)="displayType = 'list'">
                                            <icon-list-check />
                                        </button>
                                    </div>
                                    <div>
                                        <button type="button" class="btn btn-outline-primary p-2"
                                            [ngClass]="{ 'bg-primary text-white': displayType === 'grid' }"
                                            (click)="displayType = 'grid'">
                                            <icon-layout-grid />
                                        </button>
                                    </div>
                                </div>

                                <div class="relative">
                                    <input type="text" placeholder="{{ 'Search Contacts' | translate }}"
                                        class="peer form-input py-2 ltr:pr-11 rtl:pl-11" [(ngModel)]="searchUser"
                                        name="searchUser" (ngModelChange)="searchContacts()" />
                                    <div
                                        class="absolute top-1/2 -translate-y-1/2 peer-focus:text-primary ltr:right-[11px] rtl:left-[11px]">
                                        <icon-search class="mx-auto" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel mt-5 overflow-hidden border-0 p-0">
                            <ng-container *ngIf="displayType === 'list'">
                                <div class="table-responsive">
                                    <table class="table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>{{ 'Collector Name' | translate }}</th>
                                                <th>{{ 'Creation Time' | translate }}</th>
                                                <th>{{ 'Adapter' | translate }}</th>
                                                <th>{{ 'Storage Strategy' | translate }}</th>
                                                <!-- 移除表格中的 Filter Strategy 列 -->
                                                <th>{{ 'Protocol Analysis Enabled' | translate }}</th>
                                                <th>{{ 'IDS Enabled' | translate }}</th>
                                                <th class="!text-center">{{ 'Actions' | translate }}</th>
                                            </tr>
                                        </thead>
                                        <tbody>

                                            <ng-container *ngFor="let contact of filterdContactsList" key="contact.id">
                                                <tr>
                                                    <td>
                                                        {{ contact.name }}
                                                    </td>
                                                    <td>
                                                        {{ formatDate(contact.creationTime) }}
                                                    </td>
                                                    <td>{{ contact.interfaceName }}</td>
                                                    <td class="whitespace-nowrap">{{ contact.storageStrategy }}</td>
                                                    <!-- 移除表格中的 Filter Strategy 单元格 -->
                                                    <td class="whitespace-nowrap">
                                                        <label class="w-12 h-6 relative">
                                                            <input type="checkbox"
                                                                [checked]="contact.protocolAnalysisEnabled"
                                                                (change)="onProtocolAnalysisChange(contact, $event)"
                                                                class="custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer"
                                                                [id]="'protocol_switch_' + contact.id" />
                                                            <span class="outline_checkbox bg-icon border-2 border-[#ebedf2] dark:border-white-dark block h-full rounded-full before:absolute before:left-1 before:bg-[#ebedf2] dark:before:bg-white-dark before:bottom-1 before:w-4 before:h-4 before:rounded-full before:bg-[url(/assets/images/close.svg)] before:bg-no-repeat before:bg-center peer-checked:before:left-7 peer-checked:before:bg-[url(/assets/images/checked.svg)] peer-checked:border-primary peer-checked:before:bg-primary before:transition-all before:duration-300">
                                                            </span>
                                                        </label>
                                                    </td>
                                                    <td class="whitespace-nowrap">
                                                        <label class="w-12 h-6 relative">
                                                            <input type="checkbox"
                                                                [checked]="contact.idsEnabled"
                                                                (change)="onIdsChange(contact, $event)"
                                                                class="custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer"
                                                                [id]="'ids_switch_' + contact.id" />
                                                            <span class="outline_checkbox bg-icon border-2 border-[#ebedf2] dark:border-white-dark block h-full rounded-full before:absolute before:left-1 before:bg-[#ebedf2] dark:before:bg-white-dark before:bottom-1 before:w-4 before:h-4 before:rounded-full before:bg-[url(/assets/images/close.svg)] before:bg-no-repeat before:bg-center peer-checked:before:left-7 peer-checked:before:bg-[url(/assets/images/checked.svg)] peer-checked:border-primary peer-checked:before:bg-primary before:transition-all before:duration-300">
                                                            </span>
                                                        </label>
                                                    </td>
                                                    <td>
                                                        <div class="flex items-center justify-center gap-4">
                                                            <button type="button"
                                                                    class="btn btn-sm btn-outline-primary"
                                                                    (click)="editUser(contact)"
                                                                    [disabled]="contact.status === 'running' || contact.status === 'STATUS_STARTED'">
                                                                {{ 'collector.edit' | translate }}
                                                            </button>

                                                            <button type="button"
                                                                    class="btn btn-sm btn-outline-danger"
                                                                    (click)="deleteUser(contact)"
                                                                    [disabled]="contact.status === 'running' || contact.status === 'STATUS_STARTED'">
                                                                {{ 'Delete' | translate }}
                                                            </button>

                                                            <!-- 使用 ngIf 来切换显示 Start 按钮或 Animation 按钮 -->
                                                            <ng-container *ngIf="contact.status !== 'running' && contact.status !== 'STATUS_STARTED'; else analyzingButton">
                                                                <button type="button"
                                                                        class="btn btn-sm btn-outline-success"
                                                                        (click)="startCapture(contact)">
                                                                    {{ 'collector.start' | translate }}
                                                                </button>
                                                            </ng-container>
                                                            <ng-template #analyzingButton>
                                                                <button type="button"
                                                                        class="btn btn-sm btn-outline-success"
                                                                        (click)="confirmStopCapture(contact)">
                                                                    <app-analyze-animation></app-analyze-animation>
                                                                </button>
                                                            </ng-template>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                            </ng-container>
                        </div>
                        <ng-container *ngIf="displayType === 'grid'">
                            <div class="grid w-full grid-cols-1 gap-6 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4">
                                <ng-container *ngFor="let contact of filterdContactsList" key="contact.id">
                                    <div
                                        class="relative overflow-hidden rounded-md bg-white text-center shadow dark:bg-[#1c232f]">
                                        <div
                                            class="rounded-t-md bg-white/40 bg-[url('/assets/images/notification-bg.png')] bg-cover bg-center p-6 pb-0">
                                            <!-- <ng-container *ngIf="contact.path">
                                                <img class="mx-auto max-h-40 w-4/5 object-contain"
                                                    [src]="'/assets/images/' + contact.path" />
                                            </ng-container> -->
                                            <div class="relative overflow-hidden">
                                                <apx-chart [series]="revenueChart.series" [chart]="revenueChart.chart" [dataLabels]="revenueChart.dataLabels"
                                                  [stroke]="revenueChart.stroke" [colors]="revenueChart.colors" [markers]="revenueChart.markers"
                                                  [labels]="revenueChart.labels" [xaxis]="revenueChart.xaxis" [yaxis]="revenueChart.yaxis"
                                                  [grid]="revenueChart.grid" [legend]="revenueChart.legend" [tooltip]="revenueChart.tooltip"
                                                  [fill]="revenueChart.fill" class="rounded-lg bg-white dark:bg-black">
                                                  <!-- loader -->
                                                  <div class="grid min-h-[325px] place-content-center bg-white-light/30 dark:bg-dark dark:bg-opacity-[0.08]">
                                                    <span
                                                      class="inline-flex h-5 w-5 animate-spin rounded-full border-2 border-black !border-l-transparent dark:border-white"></span>
                                                  </div>
                                                </apx-chart>
                                              </div>
                                        </div>
                                        <div class="relative -mt-10 px-6 pb-24">
                                            <div class="rounded-md bg-white px-2 py-4 shadow-md dark:bg-gray-900">
                                                <div class="text-xl">{{ contact.name }}</div>
                                                <div class="text-white-dark">{{ contact.role }}</div>
                                                <div class="mt-6 flex flex-wrap items-center justify-between gap-3">
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ contact.posts }}</div>
                                                        <div>{{ 'Duration' | translate }}</div>
                                                    </div>
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ contact.following }}</div>
                                                        <div>{{ 'Event' | translate }}</div>
                                                    </div>
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ contact.followers }}</div>
                                                        <div>{{ 'Logs' | translate }}</div>
                                                    </div>
                                                </div>
                                                <!-- <div class="mt-4">
                                                    <ul
                                                        class="flex items-center justify-center space-x-4 rtl:space-x-reverse">
                                                        <li>
                                                            <a href="javascript:;"
                                                                class="btn btn-outline-primary h-7 w-7 rounded-full p-0">
                                                                <icon-facebook />
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="javascript:;"
                                                                class="btn btn-outline-primary h-7 w-7 rounded-full p-0">
                                                                <icon-instagram />
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="javascript:;"
                                                                class="btn btn-outline-primary h-7 w-7 rounded-full p-0">
                                                                <icon-linkedin />
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a href="javascript:;"
                                                                class="btn btn-outline-primary h-7 w-7 rounded-full p-0">
                                                                <icon-twitter />
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div> -->
                                            </div>
                                            <div class="mt-6 grid grid-cols-1 gap-4 ltr:text-left rtl:text-right">
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'Creation Time :' | translate }}</div>
                                                    <div class="truncate text-white-dark">{{ formatDate(contact.creationTime) }}</div>
                                                </div>
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'Adapter :' | translate }}</div>
                                                    <div class="text-white-dark">DPDK</div>
                                                </div>
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'Filter Strategy :' | translate }}</div>
                                                    <div class="text-white-dark">bbbb</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            class="absolute bottom-0 mt-6 flex w-full gap-4 p-6 ltr:left-0 rtl:right-0">
                                            <button type="button" class="btn btn-outline-primary w-1/2"
                                                (click)="editUser(contact)">{{ 'collector.edit' | translate }}</button>
                                            <button type="button" class="btn btn-outline-danger w-1/2"
                                                (click)="deleteUser(contact)">{{ 'Delete' | translate }}</button>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>

                        <!-- add contact modal -->
                        <ngx-custom-modal #addContactModal class="no-footer">
                            <ng-template #modalHeader>
                                <div class="!font-medium">{{ params.controls['id'].value ? ('collector.edit' | translate) : ('general.add' | translate) }}
                                </div>
                            </ng-template>
                            <ng-template #modalBody>
                                <form [formGroup]="params" class="text-sm" (ngSubmit)="saveUser()" ngNativeValidate>
                                    <div class="mb-5">
                                        <label for="name">{{ 'Collector Name' | translate }}</label>
                                        <input id="name" type="text" placeholder="{{ 'Enter Name' | translate }}" class="form-input"
                                            formControlName="name" />
                                    </div>
                                    <div class="mb-5">
                                        <label for="email">{{ 'Adapter List' | translate }}</label>
                                        <ng-select [items]="options" formControlName="interfaceName"  [clearable]="false"
                                            placeholder="{{ 'Select an option' | translate }}" class="custom-multiselect" (change)="onAdapterChange($event)">
                                        </ng-select>

                                    </div>

                                    <div class="mb-5" *ngIf="showChannels">
                                        <label for="ctnFile">{{ 'Channel' | translate }}</label>
                                        <label class="inline-flex mr-5">
                                            <input type="checkbox" class="form-checkbox outline-primary rounded-full" checked />
                                            <span>{{ 'Channel 1' | translate }}</span>
                                        </label>
                                        <label class="inline-flex mr-5">
                                            <input type="checkbox" class="form-checkbox outline-primary rounded-full" checked />
                                            <span>{{ 'Channel 2' | translate }}</span>
                                        </label>
                                        <label class="inline-flex mr-5">
                                            <input type="checkbox" class="form-checkbox outline-primary rounded-full" checked />
                                            <span>{{ 'Channel 3' | translate }}</span>
                                        </label>
                                        <label class="inline-flex mr-5">
                                            <input type="checkbox" class="form-checkbox outline-primary rounded-full" checked />
                                            <span>{{ 'Channel 4' | translate }}</span>
                                        </label>
                                    </div>

                                    <div class="mb-5"  *ngIf="showUpload">
                                        <div class="mt-2 flex items-center gap-3">
                                            <input type="file" (change)="onFileSelected($event)" class="form-input" accept=".pcap,.pcapng" />
                                            <button type="button" class="btn btn-outline-primary" (click)="uploadSelectedFile()">{{ 'Upload' | translate }}</button>
                                        </div>
                                        <div class="mt-2 text-xs text-white-dark" *ngIf="params.value.filePath">{{ 'Uploaded path' | translate }}: {{ params.value.filePath }}</div>
                                    </div>

                                    <div class="mb-5" *ngIf="showChannels">
                                        <label for="storageStrategy">{{ 'Storage Strategy' | translate }}</label>
                                        <ng-select [items]="storageStrategies"
                                                   formControlName="storageStrategy"
                                                   [clearable]="false"
                                                   bindLabel="name"
                                                   bindValue="name"
                                                   placeholder="{{ 'Select storage strategy' | translate }}"
                                                   class="custom-multiselect">
                                            <ng-template ng-option-tmp let-item="item">
                                                {{ item.name }} ({{ item.fileSize }}, {{ item.fileType }})
                                            </ng-template>
                                        </ng-select>
                                    </div>
                                    <!-- 隐藏添加/编辑中的 Filter Strategy 输入框 -->
                                    <!-- <div class="mb-5">
                                        <label for="occupation">{{ 'Filter Strategy' | translate }}</label>
                                        <ng-select [items]="options" formControlName="filterStrategy" [clearable]="false"
                                            placeholder="{{ 'Select an option' | translate }}" class="custom-multiselect">
                                        </ng-select>
                                    </div> -->
                                    <div class="mb-5">
                                        <label for="protocolAnalysisEnabled">{{ 'Protocol Analysis Enabled' | translate }}</label>
                                        <label class="w-12 h-6 relative">
                                            <input type="checkbox"
                                                   formControlName="protocolAnalysisEnabled"
                                                   class="custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer" />
                                            <span class="outline_checkbox bg-icon border-2 border-[#ebedf2] dark:border-white-dark block h-full rounded-full before:absolute before:left-1 before:bg-[#ebedf2] dark:before:bg-white-dark before:bottom-1 before:w-4 before:h-4 before:rounded-full before:bg-[url(/assets/images/close.svg)] before:bg-no-repeat before:bg-center peer-checked:before:left-7 peer-checked:before:bg-[url(/assets/images/checked.svg)] peer-checked:border-primary peer-checked:before:bg-primary before:transition-all before:duration-300">
                                            </span>
                                        </label>
                                    </div>
                                    <div class="mb-5">
                                        <label for="idsEnabled">{{ 'IDS Enabled' | translate }}</label>
                                        <label class="w-12 h-6 relative">
                                            <input type="checkbox"
                                                   formControlName="idsEnabled"
                                                   class="custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer" />
                                            <span class="outline_checkbox bg-icon border-2 border-[#ebedf2] dark:border-white-dark block h-full rounded-full before:absolute before:left-1 before:bg-[#ebedf2] dark:before:bg-white-dark before:bottom-1 before:w-4 before:h-4 before:rounded-full before:bg-[url(/assets/images/close.svg)] before:bg-no-repeat before:bg-center peer-checked:before:left-7 peer-checked:before:bg-[url(/assets/images/checked.svg)] peer-checked:border-primary peer-checked:before:bg-primary before:transition-all before:duration-300">
                                            </span>
                                        </label>
                                    </div>
                                    <div class="mt-8 flex items-center justify-end">
                                        <button type="button" class="btn btn-outline-danger"
                                            (click)="addContactModal.close()">{{ 'general.cancel' | translate }}</button>
                                        <button type="submit" class="btn btn-primary ltr:ml-4 rtl:mr-4">{{
                                            params.controls['id'].value ? ('general.update' | translate) : ('general.add' | translate) }}</button>
                                    </div>
                                </form>
                            </ng-template>
                        </ngx-custom-modal>
                    </div>

                </div>
                <div *ngIf="tab2.toLowerCase() === 'profile'">
                    <div>
                        <div class="flex flex-wrap items-center justify-between gap-4">
                            <h2 class="text-xl"></h2>
                            <div class="flex w-full flex-col gap-4 sm:w-auto sm:flex-row sm:items-center sm:gap-3">
                                <div class="flex gap-3">
                                    <div>
                                        <button type="button" class="btn btn-primary" (click)="editStorageStrategy()">
                                            <icon-plus class="ltr:mr-2 rtl:ml-2" />
                                            {{ 'general.add' | translate }}
                                        </button>
                                    </div>
                                    <!-- <div>
                                        <button type="button" class="btn btn-outline-primary p-2"
                                            [ngClass]="{ 'bg-primary text-white': displayType === 'list' }"
                                            (click)="displayType = 'list'">
                                            <icon-list-check />
                                        </button>
                                    </div>
                                    <div>
                                        <button type="button" class="btn btn-outline-primary p-2"
                                            [ngClass]="{ 'bg-primary text-white': displayType === 'grid' }"
                                            (click)="displayType = 'grid'">
                                            <icon-layout-grid />
                                        </button>
                                    </div> -->
                                </div>

                                <div class="relative">
                                    <input type="text" placeholder="{{ 'collector.searchStrategies' | translate }}"
                                        class="peer form-input py-2 ltr:pr-11 rtl:pl-11" [(ngModel)]="searchUser"
                                        name="searchUser" (ngModelChange)="searchContacts()" />
                                    <div
                                        class="absolute top-1/2 -translate-y-1/2 peer-focus:text-primary ltr:right-[11px] rtl:left-[11px]">
                                        <icon-search class="mx-auto" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="panel mt-5 overflow-hidden border-0 p-0">
                            <ng-container *ngIf="displayType === 'list'">
                                <div class="table-responsive">
                                    <table class="table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>{{ 'Name' | translate }}</th>
                                                <th>{{ 'Creation Time' | translate }}</th>
                                                <th>{{ 'File Size' | translate }}</th>
                                                <th>{{ 'File Count' | translate }}</th>
                                                <th>{{ 'Out of Disk Action' | translate }}</th>
                                                <th>{{ 'File Type' | translate }}</th>
                                                <th>{{ 'Trigger Type' | translate }}</th>
                                                <th class="!text-center">{{ 'Actions' | translate }}</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let strategy of storageStrategies">
                                                <td>{{ strategy.name }}</td>
                                                <td>{{ formatDate(strategy.creationTime) }}</td>
                                                <td>{{ strategy.fileSize }}</td>
                                                <td>{{ strategy.fileCount }}</td>
                                                <td>{{ strategy.outOfDiskAction }}</td>
                                                <td>{{ strategy.fileType }}</td>
                                                <td>{{ strategy.triggerType }}</td>
                                                <td>
                                                    <div class="flex items-center justify-center gap-4">
                                                        <button type="button" class="btn btn-sm btn-outline-primary"
                                                            (click)="editStorageStrategy(strategy)">{{ 'collector.edit' | translate }}</button>
                                                        <button type="button" class="btn btn-sm btn-outline-danger"
                                                            (click)="deleteStorageStrategy(strategy)">{{ 'Delete' | translate }}</button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="displayType === 'grid'">
                                <div class="grid w-full grid-cols-1 gap-6 sm:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4">
                                    <div *ngFor="let strategy of storageStrategies"
                                        class="relative overflow-hidden rounded-md bg-white text-center shadow dark:bg-[#1c232f]">
                                        <div class="rounded-t-md bg-white/40 bg-[url('/assets/images/notification-bg.png')] bg-cover bg-center p-6 pb-0">
                                            <div class="relative overflow-hidden">
                                                <apx-chart [series]="revenueChart.series" [chart]="revenueChart.chart"
                                                    [dataLabels]="revenueChart.dataLabels" [stroke]="revenueChart.stroke"
                                                    [colors]="revenueChart.colors" [markers]="revenueChart.markers"
                                                    [labels]="revenueChart.labels" [xaxis]="revenueChart.xaxis"
                                                    [yaxis]="revenueChart.yaxis" [grid]="revenueChart.grid"
                                                    [legend]="revenueChart.legend" [tooltip]="revenueChart.tooltip"
                                                    [fill]="revenueChart.fill" class="rounded-lg bg-white dark:bg-black">
                                                </apx-chart>
                                            </div>
                                        </div>
                                        <div class="relative -mt-10 px-6 pb-24">
                                            <div class="rounded-md bg-white px-2 py-4 shadow-md dark:bg-gray-900">
                                                <div class="text-xl">{{ strategy.name }}</div>
                                                <div class="mt-6 flex flex-wrap items-center justify-between gap-3">
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ strategy.fileSize }}</div>
                                                        <div>{{ 'collector.fileSize' | translate }}</div>
                                                    </div>
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ strategy.fileCount }}</div>
                                                        <div>{{ 'collector.fileCount' | translate }}</div>
                                                    </div>
                                                    <div class="flex-auto">
                                                        <div class="text-info">{{ strategy.fileType }}</div>
                                                        <div>{{ 'collector.fileType' | translate }}</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mt-6 grid grid-cols-1 gap-4 ltr:text-left rtl:text-right">
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'collector.creationTime' | translate }}:</div>
                                                    <div class="truncate text-white-dark">{{ formatDate(strategy.creationTime) }}</div>
                                                </div>
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'collector.triggerType' | translate }}:</div>
                                                    <div class="text-white-dark">{{ strategy.triggerType }}</div>
                                                </div>
                                                <div class="flex items-center">
                                                    <div class="flex-none ltr:mr-2 rtl:ml-2">{{ 'collector.outOfDiskAction' | translate }}:</div>
                                                    <div class="text-white-dark">{{ strategy.outOfDiskAction }}</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="absolute bottom-0 mt-6 flex w-full gap-4 p-6 ltr:left-0 rtl:right-0">
                                            <button type="button" class="btn btn-outline-primary w-1/2"
                                                (click)="editStorageStrategy(strategy)">{{ 'collector.edit' | translate }}</button>
                                            <button type="button" class="btn btn-outline-danger w-1/2"
                                                (click)="deleteStorageStrategy(strategy)">{{ 'general.delete' | translate }}</button>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                        <!-- 新增：抓包文件列表表格，显示 /datastore/neteyez/datastore/pcap/capture/ 下的文件 -->
                        <div class="panel mt-5 overflow-hidden border-0 p-0">
                            <div class="table-responsive">
                                <table class="table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>{{ 'File Name' | translate }}</th>
                                            <th>{{ 'Size' | translate }}</th>
                                            <th>{{ 'Creation Time' | translate }}</th>
                                            <th class="!text-center">{{ 'Actions' | translate }}</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let f of captureFiles">
                                            <td class="whitespace-nowrap">{{ f.name }}</td>
                                            <td>{{ f.size | number }}</td>
                                            <td>{{ f.creationTime | date:'yyyy-MM-dd HH:mm:ss' }}</td>
                                            <td class="!text-center">
                                                <button type="button" class="btn btn-sm btn-outline-primary" (click)="downloadFile(f)">
                                                    {{ 'Download' | translate }}
                                                </button>
                                            </td>
                                        </tr>
                                        <tr *ngIf="!captureFiles.length">
                                            <td colspan="4" class="text-center text-white-dark py-4">{{ 'No Data' | translate }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="tab2.toLowerCase() === 'contact'" >
                    <div class="panel h-full p-0 lg:col-span-2">
                        <div class="mb-5 flex items-start justify-between border-b border-[#e0e6ed] p-5 dark:border-[#1b2e4b] dark:text-white-light">
                            <a href="javascript:;" class="flex font-semibold">
                                <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-md bg-secondary text-white ltr:mr-4 rtl:ml-4">
                                    <span>PCAP</span>
                                </div>
                                <div>
                                    <h6>802.1q.vlans10-20.pcap</h6>
                                    <p class="mt-1 text-xs text-white-dark">13.1 kb · 100 packets</p>
                                </div>
                            </a>
                            <div hlMenu class="dropdown">
                                <button type="button" hlMenuButton>
                                    <icon-horizontal-dots class="text-black/70 hover:!text-primary dark:text-white/70" />
                                </button>
                                <ul *hlMenuItems @toggleAnimation class="ltr:right-0 rtl:left-0">
                                    <li>
                                        <a href="javascript:;" *hlMenuItem="let menuItem">{{ 'general.view' | translate }}</a>
                                    </li>
                                    <li>
                                        <a href="javascript:;" *hlMenuItem="let menuItem">{{ 'general.update' | translate }}</a>
                                    </li>
                                    <li>
                                        <a href="javascript:;" *hlMenuItem="let menuItem">{{ 'general.download' | translate }}</a>
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <div class="overflow-hidden">
                            <iframe src="assets/decode/index.html" width="100%" height="800px"></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 在现有模态框后面添加 Storage Strategy Modal -->
<ngx-custom-modal #storageStrategyModal class="no-footer">
    <ng-template #modalHeader>
        <div class="!font-medium">{{ storageParams.controls['id'].value ? ('collector.edit' | translate) : ('general.add' | translate) }} {{ 'collector.storageStrategy' | translate }}</div>
    </ng-template>
    <ng-template #modalBody>
        <form [formGroup]="storageParams" class="text-sm" (ngSubmit)="saveStorageStrategy()" ngNativeValidate>
            <div class="mb-5">
                <label for="name">{{ 'collector.strategyName' | translate }}</label>
                <input id="name" type="text" placeholder="{{ 'collector.enterName' | translate }}" class="form-input" formControlName="name" />
            </div>
            <div class="mb-5">
                <label for="fileSize">{{ 'collector.fileSize' | translate }}</label>
                <ng-select [items]="optionsFileSize" formControlName="fileSize" [clearable]="false"
                    placeholder="{{ 'collector.selectFileSize' | translate }}" class="custom-multiselect">
                </ng-select>
            </div>
            <div class="mb-5">
                <label for="fileCount">{{ 'collector.fileCount' | translate }}</label>
                <input id="fileCount" type="number" class="form-input" formControlName="fileCount" min="1" />
            </div>
            <div class="mb-5">
                <label for="outOfDiskAction">{{ 'collector.outOfDiskAction' | translate }}</label>
                <ng-select [items]="['Wrap', 'Stop']" formControlName="outOfDiskAction" [clearable]="false"
                    placeholder="{{ 'collector.selectAction' | translate }}" class="custom-multiselect">
                </ng-select>
            </div>
            <div class="mb-5">
                <label for="fileType">{{ 'collector.fileType' | translate }}</label>
                <div class="flex gap-4">
                    <label class="inline-flex">
                        <input type="radio" formControlName="fileType" value="PCAP" class="form-radio outline-primary" />
                        <span>PCAP</span>
                    </label>
                    <label class="inline-flex">
                        <input type="radio" formControlName="fileType" value="PCAPNG" class="form-radio outline-primary" />
                        <span>PCAPNG</span>
                    </label>
                </div>
            </div>
            <!-- <div class="mb-5">
                <label for="triggerType">{{ 'collector.triggerType' | translate }}</label>
                <ng-select [items]="optionsTrigger" formControlName="triggerType" [clearable]="false"
                    placeholder="{{ 'collector.selectTriggerType' | translate }}" class="custom-multiselect" (change)="onTriggerChange($event)">
                </ng-select>
            </div> -->

            <div class="mb-5" *ngIf="showTimeRange">
                <label for="timeRange">{{ 'collector.timeRange' | translate }}</label>
                <input type="text" mwlFlatpickr formControlName="timeRange" [options]="rangeCalendar" class="form-input" />
            </div>

            <div class="mb-5" *ngIf="showAlarm">
                <label for="alarmType">{{ 'collector.alarmType' | translate }}</label>
                <ng-select [items]="optionsAlarm" formControlName="alarmType" [clearable]="false"
                    placeholder="{{ 'collector.selectAlarmType' | translate }}" class="custom-multiselect">
                </ng-select>
            </div>

            <div class="mb-5" *ngIf="showAlarm">
                <label for="duration">{{ 'collector.durationSeconds' | translate }}</label>
                <input id="duration" type="number" class="form-input" formControlName="duration" min="1" />
            </div>

            <div class="mt-8 flex items-center justify-end">
                <button type="button" class="btn btn-outline-danger" (click)="storageStrategyModal.close()">
                    {{ 'general.cancel' | translate }}
                </button>
                <button type="submit" class="btn btn-primary ltr:ml-4 rtl:mr-4">
                    {{ storageParams.controls['id'].value ? ('general.update' | translate) : ('general.add' | translate) }}
                </button>
            </div>
        </form>
    </ng-template>
</ngx-custom-modal>
